"use strict";(self.webpackChunkjustlend_front=self.webpackChunkjustlend_front||[]).push([[382],{46555:()=>{},51382:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Q});var a=s(76998),i=s(98859),o=s(13412),l=s(93995),n=s(19523),r=s(58168),d=s(64467),c=s(87207),v=s.n(c),h=s(43002),p=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(s[a[i]]=e[a[i]])}return s};const m=function(e){return a.createElement(h.TG,null,(function(t){var s,i=t.getPrefixCls,o=t.direction,l=e.prefixCls,n=e.type,c=void 0===n?"horizontal":n,h=e.orientation,m=void 0===h?"center":h,g=e.className,x=e.children,j=e.dashed,u=e.plain,_=p(e,["prefixCls","type","orientation","className","children","dashed","plain"]),y=i("divider",l),N=m.length>0?"-".concat(m):m,w=!!x,A=v()(y,"".concat(y,"-").concat(c),(s={},(0,d.A)(s,"".concat(y,"-with-text"),w),(0,d.A)(s,"".concat(y,"-with-text").concat(N),w),(0,d.A)(s,"".concat(y,"-dashed"),!!j),(0,d.A)(s,"".concat(y,"-plain"),!!u),(0,d.A)(s,"".concat(y,"-rtl"),"rtl"===o),s),g);return a.createElement("div",(0,r.A)({className:A},_,{role:"separator"}),x&&a.createElement("span",{className:"".concat(y,"-inner-text")},x))}))};var g,x=s(67441),j=s(26559),u=s(48634),_=s(59866),y=s(25443),N=s.n(y),w=s(96843),A=s(75659),f=s(33270),b=s(97105),V=(s(83933),s(80646),s(23446));let k=(0,i.WQ)("network")(g=(0,i.WQ)("lend")(g=(0,i.WQ)("system")(g=(0,i.PA)(g=class extends a.Component{constructor(){super(),this.startInterval=async()=>{this.timerInterval||(this.timerInterval=setInterval((async()=>{}),3e3))},this.componentDidMount=()=>{this.startInterval()},this.closeOldAndOpenNewModal=()=>{this.props.lend.setData({voteOldWithdrawModalVisible:!1}),window.gtag("event","PC_invalid_vote_close",{event_category:"PC_V1.5",event_label:"invalid_vote_close"})},this.toWithdraw=async e=>{window.gtag("event","PC_invalid_vote_btn",{event_category:"PC_V1.5",event_label:"invalid_vote_btn"});const t={collateralAddress:A.Ay.contract.JST,jtokenAddress:A.Ay.contract.oldWJSTAddress,amount:(0,f.gH)(e).times(A.Ay.tokenDefaultPrecision)._toHex()},s={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:t.collateralSymbol},transType:"voteWithdraw"};this.setState({isSuccess:!1,txID:"",approving:!0});const a=t.jtokenAddress;let i="withdraw(uint256)",o=[{type:"uint256",value:t.amount}];const l=await this.props.system.getFeeLimitCommon(a,i,o);let n={feeLimit:l};t.collateralAddress===A.Ay.zeroAddr&&(i="mint()",o=[],n={callValue:t.amount,feeLimit:l});await this.props.system.voteWithdraw(t,s,n)&&this.props.lend.setData({voteOldWithdrawModalVisible:!1}),this.setState({approving:!1})},this.timerInterval=null,this.state={lang:window.localStorage.getItem("lang")||w.Ay.options.currentLocale,visible:!1,approving:!1}}componentWillUnmount(){clearInterval(this.timerInterval),this.timerInterval=null}render(){const{oldVoteInfo:e,voteOldWithdrawModalVisible:t,theme:s}=this.props.lend,{approving:a}=this.state,{transModalInfo:i}=this.props.system,{declined:o,transType:l}=i;return(0,V.jsx)(u.A,{title:w.Ay.get("v2.vote.redeem_votes"),maskClosable:!1,visible:t,closable:!0,onCancel:()=>{this.props.system.clearRejectError(),this.closeOldAndOpenNewModal()},footer:null,width:400,centered:!0,className:`vote-old-withdraw-modal-v2 ${s}`,children:(0,V.jsxs)("div",{className:"vote-old-withdraw-content",children:[(0,V.jsx)("div",{className:"tick-vote-logo"}),(0,V.jsx)("div",{className:"title",children:w.Ay.get("v2.vote.redeem_to_get")}),(0,V.jsxs)("div",{className:"amount",children:[e&&e.success&&(null===e||void 0===e?void 0:e.surplusVotes.div(A.Ay.tokenDefaultPrecision).toString())," ","JST"]}),(0,V.jsx)("div",{className:"desc",children:w.Ay.get("v2.vote.redeem_invalid_vote")}),a?(0,V.jsxs)("button",{className:"j-large-btn j-supply j-signing",disabled:!0,children:[w.Ay.get("v2.sign_in_wallet"),(0,V.jsx)("span",{className:"siging-icon"})]}):(0,V.jsx)("button",{className:"j-large-btn j-supply",onClick:()=>this.toWithdraw(e&&e.success&&(null===e||void 0===e?void 0:e.surplusVotes.div(A.Ay.tokenDefaultPrecision))),children:w.Ay.get("v2.vote.redeem_now")}),o&&"voteWithdraw"===l&&(0,V.jsxs)("div",{className:"j-error-tip wallet-reject",children:[(0,V.jsx)("span",{className:"j-error-img"}),(0,V.jsx)("div",{children:w.Ay.get("v2.reject_in_wallet")})]})]})})}})||g)||g)||g)||g;const P=k;var C=s(40437),S=s(69185),I=s(42780),T=s(94709);const D=s.p+"static/media/vote-1.297895d294c0df8bf3da725211b891db.svg";const M=s.p+"static/media/vote-1.543c36daa7840e280726a048b923cd8b.svg";var W;const B=e=>{const{endTime:t,state:s}=e,a=(new Date).getTime();a>=t&&(1===s||-1===s)&&setTimeout((()=>{window.location.reload()}),6e4);const i=t-a,o=Math.floor(i/36e5),l=Math.floor(i%36e5/6e4)>0?Math.floor(i%36e5/6e4):"<1";return`${o>0?`${o}${w.Ay.get("v2.vote.hrs")}:`:""}${l}${w.Ay.get("v2.vote.min")}`},H=e=>{let{lang:t,theme:s}=e;return(0,V.jsxs)("div",{className:"step-container",children:[(0,V.jsx)("div",{className:"left-steps",children:[...Array(3).keys()].map((e=>(e++,(0,V.jsxs)("div",{className:"step",children:[(0,V.jsx)("div",{className:"step-number",children:e}),(0,V.jsxs)("div",{className:"step-text-box",children:[(0,V.jsx)("div",{className:`step-title ${t}`,children:w.Ay.get(`v2.vote.step${e}_title`)}),(0,V.jsx)("div",{className:"step-desc",children:w.Ay.get(`v2.vote.step${e}_desc`)})]}),e<=2&&(0,V.jsx)("div",{className:"step-arrow"})]},e))))}),(0,V.jsxs)("div",{className:"right-forum",children:[(0,V.jsx)("div",{className:"forum-title",children:w.Ay.get("v2.vote.forum_title")}),(0,V.jsx)("span",{children:(0,V.jsx)("a",{href:"https://forum.justlend.org",target:"_blank",className:"jl-links",onClick:window.gtag("event","PC_join_discussion",{event_category:"PC_V1.5",event_label:"join_discussion"}),children:w.Ay.get("v2.vote.forum_desc")})})]})]})},F=e=>{let{lang:t}=e;const s="en-US"===t,a="zh-TC"===t;return(0,V.jsxs)("div",{className:"faq-container",children:[(0,V.jsxs)("div",{className:"faq-header",children:[(0,V.jsx)("div",{className:"faq-title",children:w.Ay.get("v2.vote.faq")}),(0,V.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:`https://justlendorg.zendesk.com/hc/${s?"en-us":"zh-cn"}/sections/360011296312`,className:"faq-more",onClick:window.gtag("event","PC_vote_faq_more",{event_category:"PC_V1.5",event_label:"vote_faq_more"}),children:w.Ay.get("more")})]}),(0,V.jsx)(m,{}),(0,V.jsx)("div",{className:"faq-body",children:(0,V.jsx)("ul",{children:[{url:e=>`https://justlendorg.zendesk.com/hc/${e?"en-us":"zh-cn"}/articles/360053116731`,title:(e,t)=>e?"How to get more votes?":t?"\u5982\u4f55\u514c\u63db\u9078\u7968\uff1f":"\u5982\u4f55\u5151\u6362\u9009\u7968\uff1f"},{url:e=>`https://justlendorg.zendesk.com/hc/${e?"en-us":"zh-cn"}/articles/360053116751`,title:(e,t)=>e?"How to vote on a proposal?":t?"\u5982\u4f55\u9032\u884c\u6295\u7968\uff1f":"\u5982\u4f55\u8fdb\u884c\u6295\u7968\uff1f"},{url:e=>`https://justlendorg.zendesk.com/hc/${e?"en-us":"zh-cn"}/articles/360052662212`,title:(e,t)=>e?"How to convert my votes back to JST?":t?"\u5982\u4f55\u8d16\u56de\u9078\u7968\uff1f":"\u5982\u4f55\u8d4e\u56de\u9009\u7968\uff1f"}].map(((e,t)=>(0,V.jsx)("li",{children:(0,V.jsx)("a",{href:e.url(s),target:"_blank",rel:"noopener noreferrer",onClick:window.gtag("event","PC_vote_faq_link",{event_category:"PC_V1.5",event_label:"vote_faq_link"}),children:e.title(s,a)})},t)))})})]})},L=e=>{const t=(100*e).toFixed(2);return 0==t&&0!=e?"<0.01":100==t&&1!=e?"99.99":t},$=e=>{let{forVotes:t,againstVotes:s}=e;t=parseInt(t),s=parseInt(s);const a=t+s;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("div",{className:"p-vote-bar hide-md",children:[(0,V.jsx)("div",{className:"p-for hide-md ",children:0===a?"0%":L(t/a)+"%"}),0!==t&&(0,V.jsx)("div",{className:"p-for-bar hide-md "+(t/a>=1?" per100":""),style:{width:22+t/a*128+"px"}}),0!==s&&(0,V.jsx)("div",{className:"p-against-bar hide-md "+(s/a>=1?" per100":""),style:{width:22+s/a*128+"px"}}),0===t&&0===s&&(0,V.jsx)("div",{className:"p-default-bar hide-md",style:{width:"150px"}}),(0,V.jsx)("div",{className:"p-against hide-md ",children:0===a?"0%":L(s/a)+"%"})]}),(0,V.jsxs)("div",{className:"p-vote-bar hide-lg",children:[(0,V.jsxs)("div",{className:"bar-first-row hide-lg",children:[(0,V.jsx)("div",{className:"p-for",children:0===a?"0%":L(t/a)+"%"}),(0,V.jsx)("div",{className:"p-against",children:0===a?"0%":L(s/a)+"%"})]}),(0,V.jsx)("div",{className:"bar-second-row",children:0===t&&0===s?(0,V.jsx)("div",{className:"p-default-bar hide-lg",style:{width:"128px"}}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"p-for-bar hide-lg",style:{width:0===t?"0px":0===s?"128px":12+t/a*105+"px",transform:0===s&&"none"}}),(0,V.jsx)("div",{className:"p-against-bar hide-lg",style:{width:0===s?"0px":0===t?"128px":12+s/a*105+"px",transform:0===t&&"none"}})]})})]})]})};let z=(0,i.WQ)("network")(W=(0,i.WQ)("system")(W=(0,i.WQ)("lend")(W=(0,i.PA)(W=class extends a.Component{constructor(e){var t;super(e),this.componentDidMount=async()=>{document.title="Vote - JustLend DAO",this.props.lend.setData({voteForPop:!1,redeemFromVotePop:!1});try{var e;let t=await this.props.lend.getCurrentBlock(),s=await this.props.lend.getVoteList(t);this.setState({dataList:s.arr});const a=null===(e=s.arr)||void 0===e?void 0:e[0];this.props.lend.getVoteDetail(null===a||void 0===a?void 0:a.id)}catch(t){console.log("getVoteList: ",t)}this.props.network.on("connect",(()=>{this.getMountedData()})),this.props.network.isConnected&&this.getMountedData(),window.gtag("event","PC_vote_new",{event_category:"PC_V1.5",event_label:"vote_new"})},this.getMountedData=async()=>{try{let e=await this.getApprove();this.setState({approveStatus:e},(()=>{this.props.lend.getBalanceForVote(),this.props.lend.getOldWjstBalanceForVote(),this.startInterval()}))}catch(e){console.log("getVoteDataError: ",e)}await this.props.lend.getUserWithdrawInfo()},this.startInterval=async()=>{this.timerInterval||(this.timerInterval=setInterval((async()=>{let e=await this.getApprove();this.setState({approveStatus:e}),await this.props.lend.getBalanceForVote(),await this.props.lend.getOldWjstBalanceForVote(),await this.props.lend.getUserWithdrawInfo()}),6e4))},this.getApprove=async()=>{try{let e={collateralAddress:A.Ay.contract.JST,jtokenAddress:A.Ay.contract.WJSTAddress,precision:A.Ay.tokenDefaultPrecision},t=await this.props.lend.getVoteBalanceOf(e);return(0,f.gH)(t).gt(0)}catch(e){return console.log("getApprove, ",e),!1}},this.toggleShowProposalSectionForMobile=e=>{1===e&&this.state.showProposalSectionForMobile||(2!==e||this.state.showProposalSectionForMobile)&&this.setState((e=>({...e,showProposalSectionForMobile:!e.showProposalSectionForMobile})))},this.openModal=()=>{const{isConnected:e}=this.props.network,{approveStatus:t}=this.state;this.props.system.clearRejectError(),0!==this.props.network.isRightChain?0!==this.props.network.isMainNetwork?(this.setState({isTxSigning:!1}),e?t?(this.authorize(),window.gtag("event","PC_get_votes",{event_category:"PC_V1.5",event_label:"get_votes"})):this.props.lend.setData({authorizePop:!0}):this.props.network.connectWallet()):this.props.network.showNetworkErrorModal():this.props.network.changeChain()},this.withdrawClick=()=>{const{isConnected:e}=this.props.network,{oldVoteInfo:t}=this.props.lend;this.setState({isTxSigning:!1}),e?(this.setState({exchangeVoteValue:"",withdrawValue:""}),this.props.lend.setData({withdrawPop:!0}),window.gtag("event","PC_redeem_votes",{event_category:"PC_V1.5",event_label:"redeem_votes"})):this.props.network.connectWalletV2()},this.authorize=()=>{this.setState({exchangeVoteValue:""}),this.props.lend.setData({exchangeVotePop:!0,authorizePop:!1})},this.toApprove=async()=>{this.props.system.clearRejectError();const e={collateralAddress:A.Ay.contract.JST,jtokenAddress:A.Ay.contract.WJSTAddress,transType:"approve"};this.setState({isSuccess:!1,txID:"",approving:!0});const t=e.collateralAddress;let s=[{type:"address",value:e.jtokenAddress},{type:"uint256",value:b.V9}];const a={feeLimit:await this.props.system.getFeeLimitCommon(t,"approve(address,uint256)",s)};await this.props.system.approveToken(e,[["lend/hideAuthorizePop"]],a)&&this.setState({approveStatus:!0},(()=>{this.authorize()})),this.setState({approving:!1})},this.renderApprovePop=()=>{const{approving:e}=this.state,{transModalInfo:t}=this.props.system,{declined:s,transType:a}=t;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"v-title",children:w.Ay.get("deposit.confirm_approve")}),(0,V.jsx)(m,{}),(0,V.jsx)("div",{className:"vote-authorize-logo"}),(0,V.jsx)("div",{className:"v-desc",children:w.Ay.getHTML("vote.approve_text")}),e?(0,V.jsxs)("button",{className:"modal-btn is-valid",disabled:!0,children:[w.Ay.get("v2.sign_in_wallet"),(0,V.jsx)("span",{className:"siging-icon"})]}):(0,V.jsx)("div",{className:"modal-btn is-valid",onClick:this.toApprove,children:w.Ay.get("vote.approve_btn")}),s&&"approve"===a&&(0,V.jsxs)("div",{className:"j-error-tip wallet-reject",children:[(0,V.jsx)("span",{className:"j-error-img"}),(0,V.jsx)("div",{children:w.Ay.get("v2.reject_in_wallet")})]})]})},this.chooseMax=()=>{const{voteInfo:e}=this.props.lend;let t=(0,f.ZV)(e.jstBalance.div(A.Ay.tokenDefaultPrecision),3,{per:!0});this.setState({exchangeVoteValue:t})},this.chooseWithdrawMax=()=>{const{voteInfo:e}=this.props.lend;let t=(0,f.ZV)(e.surplusVotes.div(A.Ay.tokenDefaultPrecision),3,{per:!0});this.setState({withdrawValue:t})},this.maxRender=e=>1===e?(0,V.jsx)("div",{className:"v-max-btn",onClick:this.chooseMax,children:w.Ay.get("vote.voteto_input_max")}):2===e?(0,V.jsx)("div",{className:"v-max-btn",onClick:this.chooseWithdrawMax,children:w.Ay.get("vote.voteto_input_max")}):void 0,this.exchangeVoteChange=e=>{const{valid:t,str:s}=(0,f.PY)(e,3);t&&this.setState({exchangeVoteValue:s})},this.toDeposit=async()=>{this.props.system.clearRejectError(),window.gtag("event","PC_get_votes_modal",{event_category:"PC_V1.5",event_label:"get_votes_modal"});const{voteInfo:e}=this.props.lend;this.setState({isTxSigning:!0});const t=(0,f.ZV)(e.jstBalance.div(A.Ay.tokenDefaultPrecision),3,{per:!0}),{exchangeVoteValue:s}=this.state;if((0,f.gH)(t).lt((0,f.gH)(s)))return;const a={collateralAddress:A.Ay.contract.JST,jtokenAddress:A.Ay.contract.WJSTAddress,amount:(0,f.gH)(s).times(A.Ay.tokenDefaultPrecision)._toHex()},i={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:a.collateralSymbol},transType:"depositVote"};try{const e=a.jtokenAddress;let t="deposit(uint256)",s=[{type:"uint256",value:a.amount}],o={};a.collateralAddress===A.Ay.zeroAddr&&(t="mint()",s=[],o={callValue:a.amount});const l=await this.props.system.getFeeLimitCommon(e,t,s,o),n=await this.props.system.voteDeposit(a,i,l);n?(window.gtag("event","PC_get_votes_modal_success",{event_category:"PC_V1.5",event_label:"get_votes_modal_success"}),this.setState({isSuccess:!0,txID:n,isTxSigning:!1}),this.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})):this.setState({isSuccess:!1,txID:n,isTxSigning:!1})}catch{this.setState({isSuccess:!1,isTxSigning:!1})}},this.renderDepositPop=e=>{const{voteInfo:t}=this.props.lend,{transModalInfo:s}=this.props.system,{declined:a,transType:i}=s;let o;t&&t.success&&(o=(0,f.ZV)(t.jstBalance.div(A.Ay.tokenDefaultPrecision),3,{per:!0}));const l=(0,f.gH)(o).gte((0,f.gH)(this.state.exchangeVoteValue)),n=(0,f.gH)(this.state.exchangeVoteValue).gt(0),r=!l&&n;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"v-title",children:w.Ay.get("vote.myvote_deposit")}),(0,V.jsx)(m,{}),(0,V.jsx)("div",{className:"tick-vote-logo"}),(0,V.jsx)("div",{className:"v-desc",children:w.Ay.getHTML("v2.vote.get_vote_modal_text")}),(0,V.jsxs)("div",{className:"v-desc2",children:[(0,V.jsx)("div",{className:"v-amount",children:w.Ay.get("vote.deposit_amount")}),(0,V.jsxs)("div",{className:"v-right",children:[(0,V.jsx)("div",{className:"v-text",children:w.Ay.get("wallet_ballance")}),t&&t.success&&(0,V.jsxs)("div",{className:"v-balance",children:[(0,f.ZV)(t.jstBalance.div(A.Ay.tokenDefaultPrecision),3,{miniText:.001})," JST"]}),(0,V.jsx)("a",{className:"v-get-btn hover",target:"_blank",rel:"noopener noreferrer",href:`${A.Ay.sunSwap}?lang=${this.state.lang}?tokenAddress=${A.Ay.contract.JST}&type=swap`,onClick:window.gtag("PC_get_jst_btn","click",{event_category:"PC_V1.5",event_label:"get_jst_btn"}),children:w.Ay.get("lend.get")}),(0,V.jsx)("span",{className:`v-arrow ${e}`})]})]}),(0,V.jsx)(x.A,{allowClear:!0,className:"vote-input "+(r?"invalid":""),value:(0,f.QA)(this.state.exchangeVoteValue),placeholder:w.Ay.get("vote.convert_input_tips"),suffix:this.maxRender(1),onChange:e=>this.exchangeVoteChange((0,f.DS)(e.target.value),!0),disabled:!!this.state.isTxSigning}),r&&(0,V.jsx)(V.Fragment,{children:(0,V.jsx)("div",{className:"exceed-remain-votes",children:w.Ay.get("tab.not_enough")})}),this.state.isTxSigning?(0,V.jsxs)("div",{className:"modal-btn",children:[w.Ay.get("v2.sign_in_wallet"),(0,V.jsx)("span",{className:"siging-icon"})]}):(0,V.jsx)("div",{onClick:!r&&n&&this.toDeposit||void 0,className:"modal-btn "+(!r&&n?"is-valid":""),children:w.Ay.get("v2.vote.deposit_now")}),a&&"depositVote"===i&&(0,V.jsxs)("div",{className:"tx-failed",children:[(0,V.jsx)("span",{className:"error-img"}),w.Ay.get("v2.reject_in_wallet")]})]})},this.withdrawChange=e=>{const{valid:t,str:s}=(0,f.PY)(e,3);t&&this.setState({withdrawValue:s})},this.toWithdraw=async e=>{const t={collateralAddress:A.Ay.contract.JST,jtokenAddress:A.Ay.contract.WJSTAddress,amount:(0,f.gH)(e).times(A.Ay.tokenDefaultPrecision)._toHex()},s={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:t.collateralSymbol},transType:"withdrawVote"};try{const e=t.jtokenAddress;let a="withdraw(uint256)",i=[{type:"uint256",value:t.amount}];const o=await this.props.system.getFeeLimitCommon(e,a,i);let l={feeLimit:o};t.collateralAddress===A.Ay.zeroAddr&&(a="mint()",i=[],l={callValue:t.amount,feeLimit:o});const n=await this.props.system.voteWithdraw(t,s,l);n?(window.gtag("event","PC_redeem_votes_modal_success",{event_category:"PC_V1.5",event_label:"redeem_votes_modal_success"}),this.setState({isSuccess:!0,txID:n,isTxSigning:!1}),this.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})):this.setState({isSuccess:!1,txID:n,isTxSigning:!1})}catch{this.setState({isSuccess:!1,isTxSigning:!1})}},this.withdrawSubmit=()=>{window.gtag("event","PC_redeem_votes_modal",{event_category:"PC_V1.5",event_label:"redeem_votes_modal"}),this.props.system.clearRejectError();const{withdrawValue:e}=this.state;this.setState({isTxSigning:!0}),this.toWithdraw(e)},this.renderWithdrawPop=()=>{const{voteInfo:e}=this.props.lend,{transModalInfo:t}=this.props.system,{declined:s,transType:a}=t;let i;e&&e.success&&(i=(0,f.ZV)(e.surplusVotes.div(A.Ay.tokenDefaultPrecision),3,{miniText:.001,per:!0}));const o=(0,f.gH)(i).gte((0,f.gH)(this.state.withdrawValue)),l=(0,f.gH)(this.state.withdrawValue).gt(0),n=!o&&l;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"v-title",children:w.Ay.get("v2.vote.redeem_votes")}),(0,V.jsx)(m,{}),(0,V.jsx)("div",{className:"tick-vote-logo"}),(0,V.jsx)("div",{className:"v-desc",children:w.Ay.getHTML("v2.vote.vote_modal_convert_jst")}),(0,V.jsxs)("div",{className:"v-desc2",children:[(0,V.jsx)("div",{className:"v-amount",children:w.Ay.getHTML("v2.vote.redeem_count")}),(0,V.jsxs)("div",{className:"v-right",children:[(0,V.jsx)("div",{className:"v-text",children:w.Ay.get("v2.vote.surplus_votes")}),(0,V.jsx)("div",{className:"v-balance",children:(0,f.ZV)(i)})]})]}),(0,V.jsx)(x.A,{allowClear:!0,className:"vote-input "+(n?"invalid":""),value:(0,f.QA)(this.state.withdrawValue),placeholder:w.Ay.get("v2.vote.votes_amount"),suffix:this.maxRender(2),onChange:e=>this.withdrawChange((0,f.DS)(e.target.value),!0),disabled:!!this.state.isTxSigning}),n&&(0,V.jsx)(V.Fragment,{children:(0,V.jsx)("div",{className:"exceed-remain-votes",children:w.Ay.get("tab.not_enough")})}),this.state.isTxSigning?(0,V.jsxs)("div",{className:"modal-btn",children:[w.Ay.get("v2.sign_in_wallet"),(0,V.jsx)("span",{className:"siging-icon"})]}):(0,V.jsx)("div",{onClick:!n&&l&&this.withdrawSubmit||void 0,className:"modal-btn "+(!n&&l?"is-valid":""),children:w.Ay.get("v2.vote.redeem_now")}),s&&"withdrawVote"===a&&(0,V.jsxs)("div",{className:"tx-failed",children:[(0,V.jsx)("span",{className:"error-img"}),w.Ay.get("v2.reject_in_wallet")]})]})},this.hideDepositPop=()=>{const{withdrawPop:e,exchangeVotePop:t}=this.props.lend;e?window.gtag("event","PC_redeem_votes_close",{event_category:"PC_V1.5",event_label:"redeem_votes_close"}):t&&window.gtag("event","PC_get_votes_close",{event_category:"PC_V1.5",event_label:"get_votes_close"}),this.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})},this.renderMobileMenu=()=>{const{page:e,dataList:t,showProposalSectionForMobile:s,lang:a}=this.state,i=null===t||void 0===t?void 0:t[0];return(0,V.jsxs)("div",{className:"mobile-menu",children:[(0,V.jsx)("span",{onClick:()=>this.toggleShowProposalSectionForMobile(1),className:s?"menu-item current":"menu-item",children:(0,V.jsxs)("div",{className:"p-left",children:[(0,V.jsx)("div",{className:"p-title",children:w.Ay.get("v2.vote.proposal")}),i&&(0,V.jsx)("div",{className:"p-count",children:t.length})]})}),(0,V.jsx)("span",{onClick:()=>this.toggleShowProposalSectionForMobile(2),className:s?"menu-item":"menu-item current",children:w.Ay.get("v2.vote.my_vote_header")})]})},this.renderMyVote=e=>{const{voteInfo:t,oldVoteInfo:s,userCanRedeemVoteNum:a,userVotingVoteNum:i}=this.props.lend,o=(0,f.gH)(a).eq(0)?0:(0,f.ZV)(a,3,{miniText:.001}),l=(0,f.gH)(i).eq(0)?0:(0,f.ZV)(i,3,{miniText:.001}),n=t&&t.success&&s&&s.success&&(0,f.ZV)(t.castVote.plus(s.castVote).div(A.Ay.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,r=t&&t.success&&s&&s.success&&(0,f.ZV)(t.totalVote.plus(s.totalVote).div(A.Ay.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0;let d=t&&t.success&&(0,f.ZV)(t.surplusVotes.div(A.Ay.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,c=s&&s.success&&(0,f.ZV)(s.surplusVotes.div(A.Ay.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,v=((0,f.gH)(n).gt(0)||(0,f.gH)(r).gt(0)||(0,f.gH)(d).gt(0))&&(0,f.gH)(r).gt((0,f.gH)(c));return(0,V.jsxs)("div",{className:"my-vote-container",children:[this.renderMobileMenu(),(0,V.jsx)("div",{className:"my-vote-header",children:w.Ay.get("v2.vote.my_vote_header")}),(0,V.jsx)(m,{className:"proposal-title my-vote-title"}),(0,V.jsx)("div",{className:"space-60"}),this.props.network.isConnected?v||(0,f.gH)(d).gt(0)?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(T.L,{className:"hide-lg total-votes",overlayClassName:"j-tooltip-dropdown",title:w.Ay.get("vote.myvote_help"),placement:"top",arrowPointAtCenter:!0,setIsActive:e=>this.setState({isActive:e}),children:(0,V.jsx)("span",{className:`total-votes hide-lg ${e} ${this.state.isActive?"active":""}`,children:w.Ay.get("vote.myvote_total")})}),(0,V.jsxs)("div",{className:"total-votes hide-md",children:[w.Ay.get("vote.myvote_total"),(0,V.jsx)(j.A,{overlayClassName:"j-tooltip-dropdown",title:w.Ay.get("vote.myvote_help"),arrowPointAtCenter:!0,placement:"top",trigger:["click","hover"],children:(0,V.jsx)("span",{className:"j-tooltip-icon"})})]}),(0,V.jsx)("div",{className:"total-votes-amount",children:(0,f.ZV)(r)}),(0,V.jsxs)("div",{className:"vote-info-box",children:[(0,V.jsxs)("div",{className:"vote-info-row",children:[(0,V.jsx)("div",{className:"vote-info-text",children:w.Ay.get("v2.vote.surplus")}),(0,V.jsx)("div",{className:"vote-info-amount",children:(0,f.ZV)(d)})]}),(0,V.jsxs)("div",{className:"vote-info-row",children:[(0,V.jsx)("div",{className:"vote-info-text",children:w.Ay.get("v2.vote.recycle_votes")}),(0,f.gH)(a).gt(0)?(0,V.jsx)("div",{className:"vote-info-amount clickable hover",onClick:()=>{this.props.system.clearRejectError(),this.props.lend.setData({voteDetailModalVisible:!0}),window.gtag("event","PC_recycle_votes",{event_category:"PC_V1.5",event_label:"recycle_votes"})},children:o}):(0,V.jsx)("div",{className:"vote-info-amount",children:o})]}),(0,V.jsxs)("div",{className:"vote-info-row",children:[(0,V.jsx)("div",{className:"vote-info-text",children:w.Ay.get("v2.vote.cast_votes")}),(0,V.jsx)("div",{className:"vote-info-amount",children:l})]})]}),(0,V.jsxs)("div",{className:"my-vote-btn-wrapper2",children:[(0,V.jsx)("div",{className:"my-vote-btn2",onClick:()=>this.withdrawClick(),children:w.Ay.get("v2.vote.redeem_votes")}),(0,V.jsx)("div",{className:"my-vote-btn",onClick:()=>this.openModal(),children:w.Ay.get("vote.myvote_deposit")})]}),s&&s.success&&(null===s||void 0===s?void 0:s.surplusVotes.gt(0))&&(0,V.jsx)("div",{className:"invalid-vote hover",onClick:()=>{this.props.system.clearRejectError(),this.props.lend.setData({voteOldWithdrawModalVisible:!0}),window.gtag("event","PC_invalid_vote",{event_category:"PC_V1.5",event_label:"invalid_vote"})},children:w.Ay.getHTML("v2.vote.invalid_vote",{value:c})})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"tick-vote-logo"}),(0,V.jsx)("div",{className:"my-vote-text",children:w.Ay.get("v2.vote.get_vote")}),(0,V.jsx)("div",{className:"my-vote-btn-wrapper",children:(0,V.jsx)("div",{className:"my-vote-btn",onClick:()=>this.openModal(),children:w.Ay.get("vote.myvote_deposit")})}),s&&s.success&&(null===s||void 0===s?void 0:s.surplusVotes.gt(0))&&(0,V.jsx)("div",{className:"invalid-vote hover",onClick:()=>{this.props.system.clearRejectError(),this.props.lend.setData({voteOldWithdrawModalVisible:!0}),window.gtag("event","PC_invalid_vote",{event_category:"PC_V1.5",event_label:"invalid_vote"})},children:w.Ay.getHTML("v2.vote.invalid_vote",{value:c})})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"unconnected-wallet-logo"}),(0,V.jsx)("div",{className:"my-vote-text",children:w.Ay.get("v2.vote.unconnected_wallet")}),(0,V.jsx)("div",{className:"my-vote-btn-wrapper",children:"disabled"===this.props.lend.serviceInnerStatus?(0,V.jsx)(j.A,{title:w.Ay.get("season.can_not_connect"),overlayClassName:"j-tooltip-dropdown season season-l "+e,arrowPointAtCenter:!0,placement:"bottom",getPopupContainer:()=>document.querySelector(".vote-container .right-panel .my-vote-container .my-vote-btn"),children:(0,V.jsx)("div",{className:"my-vote-btn season",onClick:()=>{this.props.lend.setData({noServiceModalAllVisible:!0})},children:w.Ay.get("navi.wallet_linkbtn")})}):(0,V.jsx)("div",{className:"my-vote-btn",onClick:()=>this.props.network.connectWalletV2(),children:w.Ay.get("navi.wallet_linkbtn")})})]})]})},this.loadingRender=()=>{const{theme:e}=this.props.lend,{mobile:t}=this.state;return(0,V.jsx)("div",{className:"vote-skeleton",children:(0,V.jsxs)("div",{className:`vote-container ${e}`,children:[(0,V.jsx)("div",{className:"common-flex",children:(0,f.eB)()}),t&&(0,V.jsx)("div",{className:"common-flex",children:(0,f.eB)()}),(0,V.jsxs)("div",{className:"step-container",children:[(0,V.jsxs)("div",{className:"left-steps",children:[(0,V.jsxs)("div",{className:"step",children:[(0,V.jsx)("div",{className:"step-number",children:"1"}),(0,V.jsxs)("div",{className:"step-text-box",children:[(0,V.jsx)("div",{className:"step-title en-US",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"step-desc",children:(0,f.eB)()})]}),(0,V.jsx)("div",{className:"step-arrow"})]}),(0,V.jsxs)("div",{className:"step",children:[(0,V.jsx)("div",{className:"step-number",children:"2"}),(0,V.jsxs)("div",{className:"step-text-box",children:[(0,V.jsx)("div",{className:"step-title en-US",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"step-desc",children:(0,f.eB)()})]}),(0,V.jsx)("div",{className:"step-arrow"})]}),(0,V.jsxs)("div",{className:"step",children:[(0,V.jsx)("div",{className:"step-number",children:"3"}),(0,V.jsxs)("div",{className:"step-text-box",children:[(0,V.jsx)("div",{className:"step-title en-US",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"step-desc",children:(0,f.eB)()})]})]})]}),(0,V.jsxs)("div",{className:"right-forum",children:[(0,V.jsx)("div",{className:"forum-title",children:(0,f.eB)()}),(0,V.jsx)("span",{children:(0,V.jsx)("a",{href:"",target:"_blank",className:"forum-desc hover",children:(0,f.eB)()})})]})]}),(0,V.jsxs)("div",{className:"body-container",children:[(0,V.jsxs)("div",{className:"proposal-container ",children:[(0,V.jsxs)("div",{className:"proposal-header",children:[(0,V.jsx)("div",{className:"proposal-left",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"proposal-right",children:(0,f.eB)()})]}),(0,V.jsx)(m,{className:"proposal-title my-vote-title"}),t&&(0,V.jsx)("div",{className:"proposal-right-btm",children:(0,f.eB)()}),(0,V.jsxs)("div",{className:"no-new-proposal",children:[(0,V.jsxs)("div",{className:"proposal1",children:[(0,V.jsx)("div",{children:(0,f.eB)()}),(0,V.jsx)("div",{children:(0,f.eB)()})]}),(0,V.jsxs)("div",{className:"proposal2",children:[(0,V.jsx)("div",{children:(0,f.eB)()}),(0,V.jsx)("div",{children:(0,f.eB)()})]})]}),(0,V.jsx)(m,{className:"proposal-title my-vote-title"}),t?(0,V.jsxs)("div",{className:"past-proposal-list",children:[(0,V.jsx)("a",{href:"",rel:"noopener noreferrer",children:(0,V.jsxs)("div",{className:"p-item",children:[(0,V.jsxs)("div",{className:"first-row",children:[(0,V.jsx)("span",{className:"p-title",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"p-green-tick"})]}),(0,V.jsxs)("div",{className:"second-row",children:[(0,V.jsx)("div",{className:"p-left",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"p-status",children:(0,f.eB)()})]})]})}),(0,V.jsx)("a",{href:"",rel:"noopener noreferrer",children:(0,V.jsxs)("div",{className:"p-item",children:[(0,V.jsxs)("div",{className:"first-row",children:[(0,V.jsx)("span",{className:"p-title",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"p-red-exclamation"})]}),(0,V.jsxs)("div",{className:"second-row",children:[(0,V.jsx)("div",{className:"p-left",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"p-status",children:(0,f.eB)()})]})]})})]}):(0,V.jsx)("div",{className:"past-proposal-list",children:new Array(6).fill(1).map(((e,t)=>(0,V.jsx)("a",{href:"",rel:"noopener noreferrer",children:(0,V.jsxs)("div",{className:"p-item",children:[(0,V.jsxs)("div",{className:"first-row",children:[(0,V.jsx)("span",{className:"p-title",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"p-green-tick"})]}),(0,V.jsxs)("div",{className:"second-row",children:[(0,V.jsx)("div",{className:"p-left",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"p-status",children:(0,f.eB)()})]})]})},t)))})]}),(0,V.jsxs)("div",{className:"right-panel hide-md",children:[(0,V.jsxs)("div",{className:"my-vote-container",children:[(0,V.jsx)("div",{className:"my-vote-header",children:(0,f.eB)()}),(0,V.jsx)(m,{className:"proposal-title my-vote-title"}),(0,V.jsx)("img",{className:"vote-skeleton-img",src:"white"===e?M:D}),(0,V.jsxs)("div",{className:"vote-info-box",children:[(0,V.jsx)("div",{className:"per-100 mb-40",children:(0,f.eB)()}),(0,V.jsx)("div",{className:"per-100",children:(0,f.eB)({rows:2})})]})]}),(0,V.jsxs)("div",{className:"faq-container",children:[(0,V.jsxs)("div",{className:"faq-header",children:[(0,V.jsx)("div",{className:"faq-title",children:(0,f.eB)()}),(0,V.jsx)("a",{rel:"noopener noreferrer",href:"",className:"faq-more",children:(0,f.eB)()})]}),(0,V.jsx)("div",{className:"ant-divider ant-divider-horizontal",role:"separator"}),(0,V.jsx)("div",{className:"faq-body",children:(0,V.jsxs)("ul",{children:[(0,V.jsx)("li",{children:(0,V.jsx)("a",{href:"",rel:"noopener noreferrer",children:(0,f.eB)()})}),(0,V.jsx)("li",{children:(0,V.jsx)("a",{href:"",rel:"noopener noreferrer",children:(0,f.eB)()})}),(0,V.jsx)("li",{children:(0,V.jsx)("a",{href:"",rel:"noopener noreferrer",children:(0,f.eB)()})})]})})]})]})]})]})})},this.state={dataList:[],page:0,showProposalSectionForMobile:!0,approveStatus:null,exchangeVoteValue:"",withdrawValue:"",isSuccess:!1,txID:"",lang:(null===(t=(0,f.Sp)())||void 0===t?void 0:t.lang)||window.localStorage.getItem("lang")||w.Ay.options.currentLocale,isTxSigning:!1,approving:!1,mobile:(0,_.A)(window.navigator).any,isActive:!1,stateMap:{"-1":{title:w.Ay.get("s7.open_for_voting"),time:"activeTime"},0:{title:w.Ay.get("s7.created"),time:"activeTime"},1:{title:w.Ay.get("s7.open_for_voting"),time:"activeTime"},2:{title:w.Ay.get("s7.cancelled"),time:"cancelTime"},3:{title:w.Ay.get("s7.rejected"),time:"endTime"},4:{title:w.Ay.get("s7.passed"),time:"endTime"},5:{title:w.Ay.get("s7.for_execution"),time:"queuedTime"},6:{title:w.Ay.get("s7.expired"),time:"queuedTime"},7:{title:w.Ay.get("s7.executed"),time:"executedTime"}}}}render(){var e,t,s;const{page:a,dataList:i,showProposalSectionForMobile:o,lang:l,mobile:n,stateMap:r}=this.state;let d=null===i||void 0===i?void 0:i[0];const c=i.filter((e=>1===e.state||-1===e.state)),v=1===(null===d||void 0===d?void 0:d.state)||-1===(null===d||void 0===d?void 0:d.state),h=i.slice(v?c.length:0,20*(a+1)),p="en-US"===l,{exchangeVotePop:g,authorizePop:x,withdrawPop:_,theme:y,addVote:b,lockNum:k,votedList:T}=this.props.lend,{defaultAccount:D}=this.props.network;let M=x||g||_,W=!0;d&&h.length>0&&(W=!1);return W?this.loadingRender():(0,V.jsxs)("div",{className:`vote-container ${y}`,children:[(0,V.jsxs)("div",{className:"common-flex",children:[(0,V.jsx)("div",{className:"common-title",children:w.Ay.get("vote.title")}),(0,V.jsx)("div",{className:"common-desc",children:w.Ay.get("v2.vote.top_desc")})]}),(0,V.jsx)(H,{lang:l,theme:y}),(0,V.jsxs)("div",{className:"body-container",children:[(0,V.jsxs)("div",{className:"proposal-container "+(o?"":"hide-md"),children:[this.renderMobileMenu(),(0,V.jsxs)("div",{className:"proposal-header",children:[(0,V.jsxs)("div",{className:"proposal-left",children:[(0,V.jsx)("div",{className:"proposal-title",children:w.Ay.get("v2.vote.proposal")}),d&&(0,V.jsx)("div",{className:"proposal-count",children:i.length})]}),d&&(0,V.jsx)("div",{className:"proposal-right",children:(0,V.jsxs)("div",{className:"new-proposal",children:[(0,V.jsx)("span",{className:"bell"}),[6,7].includes(d.state)&&(new Date).getTime()-d[null===(e=r[null===d||void 0===d?void 0:d.state])||void 0===e?void 0:e.time]>6e5?(0,V.jsx)("div",{className:"proposal-desc-bell",children:w.Ay.getHTML("s7.default_proposal",{value:d.proposalId})}):(0,V.jsxs)("div",{className:"proposal-desc-bell",children:[w.Ay.get("s7.new_proposal"),null===(t=r[d.state])||void 0===t?void 0:t.title," ",N()(d[null===(s=r[d.state])||void 0===s?void 0:s.time]+(6===d.state?2592e5:0)).format("MM-DD HH:mm")," ",(0,V.jsx)("a",{href:A.Ay.tronscanUrl+"/address/"+(null===d||void 0===d?void 0:d.proposer),target:"_blank",className:"jl-links",children:w.Ay.get("s7.learn_more")})]})]})})]}),(0,V.jsx)(m,{className:"proposal-title "+(o?"hide-md":"")}),(null===c||void 0===c?void 0:c.length)>0?c.map(((e,t)=>(0,V.jsxs)("div",{className:"active-proposal",children:[(0,V.jsx)("div",{className:"corner-tag",children:w.Ay.get("v2.vote.ongoing")}),(0,V.jsxs)("div",{className:"p-body",children:[(0,V.jsxs)("div",{className:"p-first-row",children:[(0,V.jsx)("div",{className:"p-title",children:e.title.split("&&")[[p?1:0]]}),(0,V.jsx)("a",{href:`/voteDetailNew?proposalId=${null===e||void 0===e?void 0:e.proposalId}&lang=${l}`,className:"vote-btn hide-md ml-50",onClick:window.gtag("event","click",{event_category:"PC_V1.5",event_label:"join_vote"}),children:w.Ay.get("v2.vote.join_vote")})]}),(0,V.jsxs)("div",{className:"p-second-row",children:[(0,V.jsxs)("div",{className:"p-desc",children:[(0,V.jsxs)("div",{className:"p-id",children:["#",e.id]}),D&&T&&-1!=T.indexOf(e.proposalId)&&(0,V.jsx)(j.A,{overlayClassName:"j-tooltip-dropdown",title:w.Ay.get("v2.vote.voted_before"),arrowPointAtCenter:!0,placement:"topLeft",trigger:["click","hover"],defaultVisible:!1,children:(0,V.jsx)("span",{className:"ticket-icon"})}),(0,V.jsx)("div",{className:"p-countdown-text",children:w.Ay.get("v2.vote.countdown_text")}),(0,V.jsx)("div",{className:"p-countdown-date",children:B(e)})]}),(0,V.jsxs)("div",{className:"p-right-mobile",children:[(0,V.jsx)($,{forVotes:e.forVotes,againstVotes:e.againstVotes}),(0,V.jsx)("a",{href:`/voteDetailNew?proposalId=${null===e||void 0===e?void 0:e.proposalId}&lang=${l}`,className:"vote-btn hide-lg",children:w.Ay.get("v2.vote.join_vote")})]})]})]})]},t))):(0,V.jsxs)("div",{className:"no-new-proposal",children:[(0,V.jsx)("div",{className:"proposal-title",children:w.Ay.get("v2.vote.no_new_proposal_title")}),(0,V.jsx)("span",{children:(0,V.jsx)("a",{href:"https://forum.justlend.org",className:"jl-links",onClick:window.gtag("event","PC_no_new_proposal_join_discussion",{event_category:"PC_V1.5",event_label:"no_new_proposal_join_discussion"}),children:w.Ay.get("v2.vote.no_new_proposal_desc")})})]}),(0,V.jsx)(m,{style:{padding:"0 30px"},children:w.Ay.get("v2.vote.previous_voting")}),(0,V.jsx)("div",{className:"past-proposal-list",children:d&&h.length>0?h.map((e=>(0,V.jsx)("a",{href:`/voteDetailNew?proposalId=${e.proposalId}&lang=${l}`,target:"_blank",rel:"noopener noreferrer",onClick:window.gtag("event","PC_vote_proposal_list",{event_category:"PC_V1.5",event_label:"vote_proposal_list"}),children:(0,V.jsxs)("div",{className:"p-item",children:[(0,V.jsxs)("div",{className:"first-row",children:[(0,V.jsxs)("span",{className:"p-title",children:[e.title.split("&&")[p?1:0],(0,V.jsx)("span",{className:"arrow-right"})]}),(0,V.jsx)("div",{className:e.state>=4?"p-green-tick":"p-red-exclamation"})]}),(0,V.jsxs)("div",{className:"second-row",children:[(0,V.jsxs)("div",{className:"p-left",children:[(0,V.jsxs)("div",{className:"p-id",children:["#",e.id]}),T&&-1!=T.indexOf(e.proposalId)&&(0,V.jsx)(j.A,{overlayClassName:"j-tooltip-dropdown",title:w.Ay.get("v2.vote.voted_before"),arrowPointAtCenter:!0,placement:"top",trigger:["click","hover"],children:(0,V.jsx)("span",{className:"ticket-icon"})}),(0,V.jsx)("div",{className:"p-date",children:new Date(e.endTime).format("yyyy-MM-dd h:m:s")})]}),(0,V.jsx)("div",{className:"p-status",children:e.exIntl?e.exIntl:e.intl})]})]},e.id)},e.id))):(0,f.Hf)()}),i.length>20&&h.length<i.length&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(m,{className:"proposal-title mb20"}),(0,V.jsx)("div",{className:"load-more mb4",onClick:()=>this.setState((e=>({...e,page:e.page+1}))),children:w.Ay.get("load_more")})]})]}),(0,V.jsxs)("div",{className:"right-panel "+(o?"hide-md":""),children:[this.renderMyVote(y),(0,V.jsx)(F,{lang:l})]})]}),(0,V.jsx)(u.A,{visible:M,width:n?"calc(100% - 40px)":400,footer:null,className:`vote-modal ${y}`,centered:!0,onCancel:()=>{this.props.system.clearRejectError(),this.hideDepositPop()},children:x?this.renderApprovePop():g?this.renderDepositPop(y):this.renderWithdrawPop()}),(0,V.jsx)(C.A,{}),(0,V.jsx)(S.A,{}),(0,V.jsx)(P,{}),(0,V.jsx)(I.A,{theme:y})]})}})||W)||W)||W)||W;const O=z;var q,R=s(25034);s(46555),s(95893);let E=(0,i.WQ)("network")(q=(0,i.WQ)("lend")(q=(0,i.WQ)("system")(q=(0,i.PA)(q=class extends a.Component{constructor(e){super(e),this.state={}}render(){const{theme:e}=this.props.lend;return(0,V.jsxs)("div",{className:"j-wrapper "+e+(A.TS.winterThemeVisible?" snow-show":""),children:[A.TS.winterThemeVisible&&(0,V.jsx)(R.A,{fromPage:"vote"}),(0,V.jsx)(l.A,{}),(0,V.jsx)(n.A,{pageName:"vote"}),(0,V.jsx)("div",{className:"j-container j-home",children:(0,V.jsx)(O,{})}),(0,V.jsx)(o.A,{})]})}})||q)||q)||q)||q;const J=E;var Z;const Q=(0,i.WQ)("network")(Z=(0,i.PA)(Z=class extends a.Component{constructor(e){super(e)}componentDidMount(){this.props.network.setData({routeName:"vote"})}render(){return(0,V.jsx)(J,{})}})||Z)||Z},69185:(e,t,s)=>{s.d(t,{A:()=>v});var a,i=s(76998),o=s(98859),l=s(33270),n=s(48634),r=s(96843),d=s(75659),c=(s(83933),s(80646),s(23446));const v=(0,o.WQ)("network")(a=(0,o.WQ)("lend")(a=(0,o.WQ)("system")(a=(0,o.PA)(a=class extends i.Component{constructor(){var e;super(),e=this,this.startInterval=async()=>{this.timerInterval||(this.timerInterval=setInterval((async()=>{}),3e3))},this.componentDidMount=()=>{this.startInterval()},this.withdrawVotes=async e=>{window.gtag("event","PC_recycle_votes_modal",{event_category:"PC_V1.5",event_label:"recycle_votes_modal"}),this.setState({clickProposalId:e}),this.props.system.clearRejectError();const{oldVoteLastId:t}=d.Ay;let s={proposalId:e,contractAddr:e<=t?d.Ay.contract.oldWJSTAddress:d.Ay.contract.WJSTAddress};const a={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:s.votes,token:s.proposalId||""},transType:"withdrawVotes"},i=s.contractAddr;let o=[{type:"uint256",value:s.proposalId}];const l={feeLimit:await this.props.system.getFeeLimitCommon(i,"withdrawVotes(uint256)",o)};await this.props.system.withdrawVotes(s,a,l)?(window.gtag("event","PC_recycle_votes_modal_success",{event_category:"PC_V1.5",event_label:"recycle_votes_modal_success"}),this.props.lend.setData({redeemFromVotePop:!1}),this.setState({clickProposalId:""})):this.setState({clickProposalId:""})},this.renderVoting=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{voteSourceData:a}=e.props.lend,{lang:i,clickProposalId:o}=e.state;if((null===t||void 0===t?void 0:t.length)>0)return null===t||void 0===t?void 0:t.map(((t,n)=>{var d,v;const h=(0,l.gH)(t.allVotes).eq(0)?"0":(0,l.gH)(t.allVotes).lt(.001)?"< 0.001":(0,l.ZV)(t.allVotes,3);return(0,c.jsxs)("div",{className:"vote-detail-item",children:[(0,c.jsxs)("div",{className:"hide-md",children:[(0,c.jsxs)("div",{className:"proposalId",children:["#",null===t||void 0===t?void 0:t.proposalId]}),(0,c.jsx)("div",{className:"title "+("en-US"===i?"":"zh"),children:a&&null!==(d=a[null===t||void 0===t?void 0:t.proposalId])&&void 0!==d&&d.title?"en-US"===i?a[t.proposalId].title.split("&&")[1]:a[t.proposalId].title.split("&&")[0]:""}),(0,c.jsx)("div",{className:"amount ellipsis",title:h,children:h}),s&&(o?o===t.proposalId?(0,c.jsx)("div",{className:"link disabled",children:(0,c.jsx)("span",{className:"siging-icon"})}):(0,c.jsx)("div",{className:"link disabled",children:r.Ay.get("v2.vote.redeem_vote_btn")}):(0,c.jsx)("div",{className:"link",onClick:()=>e.withdrawVotes(t.proposalId),children:r.Ay.get("v2.vote.redeem_vote_btn")}))]}),(0,c.jsxs)("div",{className:"hide-pc",children:[(0,c.jsxs)("div",{className:"proposalId",children:["#",null===t||void 0===t?void 0:t.proposalId]}),(0,c.jsxs)("div",{className:"middle-part",children:[(0,c.jsx)("div",{className:"title "+("en-US"===i?"":"zh"),children:a&&null!==(v=a[null===t||void 0===t?void 0:t.proposalId])&&void 0!==v&&v.title?"en-US"===i?a[t.proposalId].title.split("&&")[1]:a[t.proposalId].title.split("&&")[0]:""}),(0,c.jsx)("div",{className:"amount ellipsis",title:h,children:h})]}),s&&(o?o===t.proposalId?(0,c.jsx)("div",{className:"link disabled",children:(0,c.jsx)("span",{className:"siging-icon"})}):(0,c.jsx)("div",{className:"link disabled",children:r.Ay.get("v2.vote.redeem_vote_btn")}):(0,c.jsx)("div",{className:"link",onClick:()=>e.withdrawVotes(t.proposalId),children:r.Ay.get("v2.vote.redeem_vote_btn")}))]})]},n)}))},this.timerInterval=null,this.state={lang:window.localStorage.getItem("lang")||r.Ay.options.currentLocale,visible:!1,clickProposalId:""}}componentWillUnmount(){clearInterval(this.timerInterval),this.timerInterval=null}render(){const{userCanRedeemVoteList:e,userVotingVote:t,voteDetailModalVisible:s,userCanRedeemVoteNum:a,theme:i}=this.props.lend,{clickProposalId:o}=this.state,{transModalInfo:d}=this.props.system,{declined:v,transType:h}=d,p=(0,l.gH)(a).eq(0)?0:(0,l.ZV)(a,3,{miniText:.001});return(0,c.jsxs)(n.A,{title:r.Ay.get("v2.vote.recovered_vote"),maskClosable:!1,visible:s,closable:!0,onCancel:()=>{this.props.system.clearRejectError(),this.props.lend.setData({voteDetailModalVisible:!1}),window.gtag("event","PC_recycle_votes_close",{event_category:"PC_V1.5",event_label:"recycle_votes_close"})},footer:null,className:`vote-detail-modal-v2 ${i}`,width:457,centered:!0,children:[(0,c.jsx)("div",{className:"tick-vote-logo"}),(0,c.jsx)("p",{className:"redeemNum",children:r.Ay.getHTML("v2.vote.recover_vote",{value:p})}),t&&(null===t||void 0===t?void 0:t.length)>0||e&&(null===e||void 0===e?void 0:e.length)>0?(0,c.jsxs)("div",{className:"vote-detail-container",children:[e.length>4&&(0,c.jsx)("div",{className:"linear"}),e&&(null===e||void 0===e?void 0:e.length)>0&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:"box",children:this.renderVoting(e,!0)})}),o?(0,c.jsx)("div",{className:"info",children:(0,c.jsxs)("div",{className:"j-sign-tip flex aic jcc",children:[(0,c.jsx)("span",{className:"j-warning-icon"}),(0,c.jsx)("span",{children:r.Ay.get("v2.sign_in_wallet")})]})}):v&&"withdrawVotes"===h&&(0,c.jsx)("div",{className:"info",children:(0,c.jsxs)("div",{className:"j-reject-tip",children:[(0,c.jsx)("span",{className:"j-reject-img mt-3"}),(0,c.jsx)("span",{children:r.Ay.get("v2.reject_in_wallet")})]})})]}):null]})}})||a)||a)||a)||a},80646:()=>{}}]);